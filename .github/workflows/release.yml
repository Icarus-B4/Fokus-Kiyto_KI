name: Release Build

on:
  push:
    tags:
      - 'v*.*.*'

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 30
    
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Set up JDK 17
        uses: actions/setup-java@v3
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Setup Gradle
        uses: gradle/actions/setup-gradle@v4
        with:
          gradle-version: wrapper
          cache-read-only: false
          gradle-home-cache-cleanup: true
          cache-encryption-key: ${{ secrets.GRADLE_ENCRYPTION_KEY || 'default-key' }}

      - name: Setup Android SDK
        uses: android-actions/setup-android@v3

      - name: Install Android SDK Components
        run: |
          echo "Installing Android SDK components..."
          mkdir -p $ANDROID_HOME/cmdline-tools/latest
          
          echo "Installing build tools..."
          yes | sdkmanager \
            "platform-tools" \
            "build-tools;33.0.0" \
            "platforms;android-33" \
            "extras;android;m2repository" \
            "extras;google;m2repository"
          
          echo "Accepting licenses..."
          yes | sdkmanager --licenses
          
          echo "Setting build tools path..."
          echo "ANDROID_BUILD_TOOLS=$ANDROID_HOME/build-tools/33.0.0" >> $GITHUB_ENV
          echo "$ANDROID_HOME/build-tools/33.0.0" >> $GITHUB_PATH
          
          echo "Verifying installation..."
          ls -la $ANDROID_HOME/build-tools/33.0.0/
          $ANDROID_HOME/build-tools/33.0.0/aapt version

      - name: Create Root build.gradle
        run: |
          cat > build.gradle.kts << 'EOF'
          // Top-level build file
          plugins {
              id("com.android.application") version "8.2.2" apply false
              id("com.android.library") version "8.2.2" apply false
              id("org.jetbrains.kotlin.android") version "1.9.22" apply false
              id("org.jetbrains.kotlin.jvm") version "1.9.22" apply false
              id("androidx.navigation.safeargs.kotlin") version "2.7.7" apply false
              id("com.google.dagger.hilt.android") version "2.50" apply false
          }
          EOF

      - name: Create App build.gradle
        run: |
          mkdir -p app
          cat > app/build.gradle.kts << 'EOF'
          plugins {
              id("com.android.application")
              id("org.jetbrains.kotlin.android")
              id("org.jetbrains.kotlin.kapt")
              id("com.google.dagger.hilt.android")
              id("androidx.navigation.safeargs.kotlin")
          }

          android {
              namespace = "com.icarus.kiytoapp"
              compileSdk = 34

              defaultConfig {
                  applicationId = "com.icarus.kiytoapp"
                  minSdk = 24
                  targetSdk = 34
                  versionCode = 1
                  versionName = "1.0"
                  testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"
              }

              buildTypes {
                  release {
                      isMinifyEnabled = true
                      isShrinkResources = true
                      proguardFiles(
                          getDefaultProguardFile("proguard-android-optimize.txt"),
                          "proguard-rules.pro"
                      )
                  }
              }

              buildFeatures {
                  compose = true
                  buildConfig = true
              }

              composeOptions {
                  kotlinCompilerExtensionVersion = "1.5.8"
              }

              compileOptions {
                  sourceCompatibility = JavaVersion.VERSION_17
                  targetCompatibility = JavaVersion.VERSION_17
              }

              kotlinOptions {
                  jvmTarget = "17"
              }

              packaging {
                  resources {
                      excludes += "/META-INF/{AL2.0,LGPL2.1}"
                  }
              }
          }

          dependencies {
              // AndroidX Core
              implementation("androidx.core:core-ktx:1.12.0")
              implementation("androidx.lifecycle:lifecycle-runtime-ktx:2.7.0")
              
              // Compose
              implementation("androidx.activity:activity-compose:1.8.2")
              implementation(platform("androidx.compose:compose-bom:2024.02.00"))
              implementation("androidx.compose.ui:ui")
              implementation("androidx.compose.ui:ui-graphics")
              implementation("androidx.compose.ui:ui-tooling-preview")
              implementation("androidx.compose.material3:material3")
              
              // Navigation
              implementation("androidx.navigation:navigation-fragment-ktx:2.7.7")
              implementation("androidx.navigation:navigation-ui-ktx:2.7.7")
              
              // Room
              implementation("androidx.room:room-runtime:2.6.1")
              implementation("androidx.room:room-ktx:2.6.1")
              kapt("androidx.room:room-compiler:2.6.1")
              
              // Hilt
              implementation("com.google.dagger:hilt-android:2.50")
              kapt("com.google.dagger:hilt-android-compiler:2.50")
              
              // Retrofit
              implementation("com.squareup.retrofit2:retrofit:2.9.0")
              implementation("com.squareup.retrofit2:converter-gson:2.9.0")
              implementation("com.squareup.okhttp3:okhttp:4.12.0")
              implementation("com.squareup.okhttp3:logging-interceptor:4.12.0")
              
              // Coil
              implementation("io.coil-kt:coil:2.5.0")
              implementation("io.coil-kt:coil-compose:2.5.0")
              
              // Accompanist
              implementation("com.google.accompanist:accompanist-permissions:0.32.0")
              
              // Lottie
              implementation("com.airbnb.android:lottie:6.1.0")
              
              // Testing
              testImplementation("junit:junit:4.13.2")
              androidTestImplementation("androidx.test.ext:junit:1.1.5")
              androidTestImplementation("androidx.test.espresso:espresso-core:3.5.1")
              androidTestImplementation(platform("androidx.compose:compose-bom:2024.02.00"))
              androidTestImplementation("androidx.compose.ui:ui-test-junit4")
              debugImplementation("androidx.compose.ui:ui-tooling")
              debugImplementation("androidx.compose.ui:ui-test-manifest")
          }
          EOF

      - name: Create App Structure
        run: |
          # Create main directory structure
          mkdir -p app/src/main/java/com/icarus/kiytoapp
          mkdir -p app/src/main/res/layout
          mkdir -p app/src/main/res/values
          
          # Create AndroidManifest.xml
          cat > app/src/main/AndroidManifest.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <manifest xmlns:android="http://schemas.android.com/apk/res/android">
              <application
                  android:name=".KiytoApplication"
                  android:allowBackup="true"
                  android:icon="@mipmap/ic_launcher"
                  android:label="@string/app_name"
                  android:roundIcon="@mipmap/ic_launcher_round"
                  android:supportsRtl="true"
                  android:theme="@style/Theme.KiytoApp">
                  <activity
                      android:name=".MainActivity"
                      android:exported="true">
                      <intent-filter>
                          <action android:name="android.intent.action.MAIN" />
                          <category android:name="android.intent.category.LAUNCHER" />
                      </intent-filter>
                  </activity>
              </application>
          </manifest>
          EOF
          
          # Create Application class
          cat > app/src/main/java/com/icarus/kiytoapp/KiytoApplication.kt << 'EOF'
          package com.icarus.kiytoapp
          
          import android.app.Application
          import dagger.hilt.android.HiltAndroidApp
          
          @HiltAndroidApp
          class KiytoApplication : Application()
          EOF
          
          # Create MainActivity
          cat > app/src/main/java/com/icarus/kiytoapp/MainActivity.kt << 'EOF'
          package com.icarus.kiytoapp
          
          import android.os.Bundle
          import androidx.activity.ComponentActivity
          import androidx.activity.compose.setContent
          import androidx.compose.material3.Text
          import androidx.compose.runtime.Composable
          import androidx.compose.ui.tooling.preview.Preview
          import dagger.hilt.android.AndroidEntryPoint
          
          @AndroidEntryPoint
          class MainActivity : ComponentActivity() {
              override fun onCreate(savedInstanceState: Bundle?) {
                  super.onCreate(savedInstanceState)
                  setContent {
                      MainScreen()
                  }
              }
          }
          
          @Composable
          fun MainScreen() {
              Text(text = "Welcome to KiytoApp!")
          }
          
          @Preview
          @Composable
          fun MainScreenPreview() {
              MainScreen()
          }
          EOF
          
          # Create basic resources
          cat > app/src/main/res/values/strings.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <resources>
              <string name="app_name">KiytoApp</string>
              
              <!-- Login Strings -->
              <string name="welcome_title">Willkommen bei KiytoApp</string>
              <string name="login_subtitle">Bitte melden Sie sich an, um fortzufahren</string>
              <string name="email">E-Mail</string>
              <string name="password">Passwort</string>
              <string name="login">Anmelden</string>
              <string name="register">Registrieren</string>
              <string name="forgot_password">Passwort vergessen?</string>
              <string name="register_subtitle">Erstellen Sie ein neues Konto</string>
              <string name="confirm_password">Passwort bestätigen</string>
              
              <!-- About Me Strings -->
              <string name="web_content">Webseite</string>
              <string name="x_tweeter">Twitter</string>
              <string name="e_mail">E-Mail</string>
              
              <!-- AI Recommendations Strings -->
              <string name="productivity_analysis">Produktivitätsanalyse</string>
              <string name="focus_recommendations">Fokus-Empfehlungen</string>
              <string name="task_optimization">Aufgabenoptimierung</string>
              <string name="no_tasks_yet">Noch keine Aufgaben vorhanden</string>
              
              <!-- Chat Strings -->
              <string name="message_hint">Nachricht eingeben...</string>
              <string name="send_message">Senden</string>
              
              <!-- Task Strings -->
              <string name="task_title">Aufgabentitel</string>
              <string name="task_description">Aufgabenbeschreibung</string>
              <string name="due_date">Fälligkeitsdatum</string>
              <string name="due_time">Fälligkeitszeit</string>
              <string name="priority">Priorität</string>
              <string name="tags">Tags</string>
              <string name="save">Speichern</string>
              <string name="active_tasks">Aktive Aufgaben</string>
              <string name="completed_tasks">Erledigte Aufgaben</string>
              
              <!-- Mindmap Strings -->
              <string name="mindmap_description">Mindmap-Beschreibung</string>
              <string name="zoom_in">Vergrößern</string>
              <string name="zoom_out">Verkleinern</string>
              <string name="reset_view">Ansicht zurücksetzen</string>
              
              <!-- Settings Strings -->
              <string name="settings">Einstellungen</string>
          </resources>
          EOF
          
          cat > app/src/main/res/values/themes.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <resources>
              <style name="Theme.KiytoApp" parent="android:Theme.Material.Light.NoActionBar" />
              
              <!-- Material3 Styles -->
              <style name="TextAppearance.Material3.TitleLarge" parent="android:TextAppearance.Large">
                  <item name="android:textSize">22sp</item>
                  <item name="android:textStyle">bold</item>
              </style>
              
              <style name="Widget.Material3.Button.IconButton" parent="android:Widget.Button">
                  <item name="android:background">?android:attr/selectableItemBackgroundBorderless</item>
                  <item name="android:minWidth">48dp</item>
                  <item name="android:minHeight">48dp</item>
                  <item name="android:padding">12dp</item>
                  <item name="android:textColor">?android:attr/textColorPrimary</item>
              </style>
          </resources>
          EOF

      - name: Create Proguard Rules
        run: |
          cat > app/proguard-rules.pro << 'EOF'
          # Allgemeine Android Regeln
          -keepattributes *Annotation*
          -keepattributes SourceFile,LineNumberTable
          -keep public class * extends java.lang.Exception
          -keep class com.icarus.kiytoapp.data.** { *; }
          -keep class com.icarus.kiytoapp.domain.** { *; }
          
          # Retrofit
          -keepattributes Signature
          -keepattributes Exceptions
          -keep class retrofit2.** { *; }
          -keepclasseswithmembers class * {
              @retrofit2.http.* <methods>;
          }
          
          # OkHttp
          -keepnames class okhttp3.internal.publicsuffix.PublicSuffixDatabase
          -dontwarn org.codehaus.mojo.animal_sniffer.*
          -dontwarn okhttp3.internal.platform.**
          
          # Gson
          -keepattributes Signature
          -keepattributes *Annotation*
          -dontwarn sun.misc.**
          -keep class com.google.gson.** { *; }
          
          # Hilt
          -keepclasseswithmembers class * {
              @dagger.* <methods>;
          }
          
          # Room
          -keep class * extends androidx.room.RoomDatabase
          -dontwarn androidx.room.paging.**
          
          # Lottie
          -keep class com.airbnb.android.** { *; }
          EOF

      - name: Setup Gradle Properties
        run: |
          echo "org.gradle.jvmargs=-Xmx4g -XX:MaxMetaspaceSize=512m" > gradle.properties
          echo "android.useAndroidX=true" >> gradle.properties
          echo "android.enableJetifier=true" >> gradle.properties
          echo "org.gradle.daemon=false" >> gradle.properties
          echo "org.gradle.parallel=false" >> gradle.properties
          echo "gradle.enterprise.url=https://ge.gradle.org" >> gradle.properties
          echo "gradle.enterprise.build.scan.terms-of-service-url=https://gradle.com/terms-of-service" >> gradle.properties
          echo "gradle.enterprise.build.scan.terms-of-service-agree=yes" >> gradle.properties

      - name: Setup Settings Gradle
        run: |
          cat > settings.gradle.kts << 'EOF'
          pluginManagement {
              repositories {
                  google()
                  mavenCentral()
                  gradlePluginPortal()
              }
          }

          dependencyResolutionManagement {
              repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
              repositories {
                  google() {
                      content {
                          // Explicitly include androidx.navigation
                          includeGroupByRegex("androidx\\.navigation.*")
                      }
                  }
                  mavenCentral()
                  maven { url = uri("https://jitpack.io") }
                  maven { url = uri("https://maven.google.com") }
                  maven { url = uri("https://androidx.dev/snapshots/latest/artifacts/repository") }
              }
          }

          rootProject.name = "KiytoApp"
          include(":app")
          EOF

      # Create Lottie Animation Files before building
      - name: Create Lottie Animation Files
        run: |
          # Create raw directory for Lottie animations
          mkdir -p app/src/main/res/raw
          
          # Create a simple JSON for Lottie (minimal placeholder)
          cat > app/src/main/res/raw/loading_animation.json << 'EOF'
          {"v":"5.5.7","meta":{"g":"LottieFiles AE 0.1.20","a":"","k":"","d":"","tc":""},"fr":30,"ip":0,"op":60,"w":512,"h":512,"nm":"Loading","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Shape Layer 1","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":0,"s":[0]},{"t":59,"s":[360]}],"ix":10},"p":{"a":0,"k":[256,256,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[200,200],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0.2,0.4,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":20,"ix":5},"lc":2,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":60,"st":0,"bm":0}],"markers":[]}
          EOF
          
          # Create a second animation for variety
          cat > app/src/main/res/raw/success_animation.json << 'EOF'
          {"v":"5.5.7","meta":{"g":"LottieFiles AE 0.1.20","a":"","k":"","d":"","tc":""},"fr":30,"ip":0,"op":60,"w":512,"h":512,"nm":"Success","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Check","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[256,256,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":15,"s":[0,0,100]},{"t":30,"s":[100,100,100]}],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0]],"v":[[-50,0],[0,50],[100,-50]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.2,0.8,0.4,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":20,"ix":5},"lc":2,"lj":2,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Check","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":30,"s":[0]},{"t":45,"s":[100]}],"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":25,"s":[0]},{"t":40,"s":[100]}],"ix":2},"o":{"a":0,"k":0,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false}],"ip":0,"op":60,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Circle","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[256,256,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":0,"s":[0,0,100]},{"t":15,"s":[100,100,100]}],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[200,200],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.2,0.8,0.4,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":60,"st":0,"bm":0}],"markers":[]}
          EOF

      # Create all layout files before building
      - name: Create Additional Layouts
        run: |
          # Create layout directory if it doesn't exist
          mkdir -p app/src/main/res/layout
          
          # Create activity_main.xml
          cat > app/src/main/res/layout/activity_main.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:app="http://schemas.android.com/apk/res-auto"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent"
              tools:context=".MainActivity">
          
              <TextView
                  android:id="@+id/welcomeTextView"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:text="@string/app_name"
                  android:textAppearance="@style/TextAppearance.Material3.TitleLarge"
                  app:layout_constraintBottom_toBottomOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
          
              <com.airbnb.lottie.LottieAnimationView
                  android:id="@+id/animationView"
                  android:layout_width="200dp"
                  android:layout_height="200dp"
                  android:layout_marginTop="24dp"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/welcomeTextView"
                  app:lottie_autoPlay="true"
                  app:lottie_loop="true"
                  app:lottie_rawRes="@raw/loading_animation" />
              
              <Button
                  android:id="@+id/settingsButton"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_margin="16dp"
                  android:text="@string/settings"
                  style="@style/Widget.Material3.Button.IconButton"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
          
          </androidx.constraintlayout.widget.ConstraintLayout>
          EOF
          
          # Create activity_about_me.xml
          cat > app/src/main/res/layout/activity_about_me.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:app="http://schemas.android.com/apk/res-auto"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent">
              
              <TextView
                  android:id="@+id/aboutMeTitle"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="32dp"
                  android:text="@string/app_name"
                  android:textAppearance="@style/TextAppearance.Material3.TitleLarge"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
                  
              <TextView
                  android:id="@+id/webContentLabel"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="32dp"
                  android:layout_marginStart="24dp"
                  android:text="@string/web_content"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/aboutMeTitle" />
                  
              <TextView
                  android:id="@+id/xTweeterLabel"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="16dp"
                  android:layout_marginStart="24dp"
                  android:text="@string/x_tweeter"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/webContentLabel" />
                  
              <TextView
                  android:id="@+id/emailLabel"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="16dp"
                  android:layout_marginStart="24dp"
                  android:text="@string/e_mail"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/xTweeterLabel" />
                  
              <com.airbnb.lottie.LottieAnimationView
                  android:id="@+id/aboutMeAnimation"
                  android:layout_width="200dp"
                  android:layout_height="200dp"
                  android:layout_marginTop="32dp"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/emailLabel"
                  app:lottie_autoPlay="true"
                  app:lottie_loop="true"
                  app:lottie_rawRes="@raw/success_animation" />
                  
          </androidx.constraintlayout.widget.ConstraintLayout>
          EOF
          
          # Create activity_ai_recommendations.xml
          cat > app/src/main/res/layout/activity_ai_recommendations.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:app="http://schemas.android.com/apk/res-auto"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent">
              
              <TextView
                  android:id="@+id/aiRecommendationsTitle"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="32dp"
                  android:text="@string/ai_recommendations"
                  android:textAppearance="@style/TextAppearance.Material3.TitleLarge"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
                  
              <TextView
                  android:id="@+id/productivityAnalysisLabel"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="32dp"
                  android:layout_marginStart="24dp"
                  android:layout_marginEnd="24dp"
                  android:text="@string/productivity_analysis"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/aiRecommendationsTitle" />
                  
              <TextView
                  android:id="@+id/focusRecommendationsLabel"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="16dp"
                  android:layout_marginStart="24dp"
                  android:layout_marginEnd="24dp"
                  android:text="@string/focus_recommendations"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/productivityAnalysisLabel" />
                  
              <TextView
                  android:id="@+id/taskOptimizationLabel"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="16dp"
                  android:layout_marginStart="24dp"
                  android:layout_marginEnd="24dp"
                  android:text="@string/task_optimization"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/focusRecommendationsLabel" />
                  
              <TextView
                  android:id="@+id/noTasksYetLabel"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:text="@string/no_tasks_yet"
                  android:visibility="gone"
                  app:layout_constraintBottom_toBottomOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
                  
              <com.airbnb.lottie.LottieAnimationView
                  android:id="@+id/aiRecommendationsAnimation"
                  android:layout_width="200dp"
                  android:layout_height="200dp"
                  android:layout_marginTop="32dp"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/taskOptimizationLabel"
                  app:lottie_autoPlay="true"
                  app:lottie_loop="true"
                  app:lottie_rawRes="@raw/loading_animation" />
                  
          </androidx.constraintlayout.widget.ConstraintLayout>
          EOF
          
          # Create activity_chat.xml
          cat > app/src/main/res/layout/activity_chat.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:app="http://schemas.android.com/apk/res-auto"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent">
              
              <TextView
                  android:id="@+id/chatTitle"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="16dp"
                  android:text="@string/chat"
                  android:textAppearance="@style/TextAppearance.Material3.TitleLarge"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
                  
              <androidx.recyclerview.widget.RecyclerView
                  android:id="@+id/chatRecyclerView"
                  android:layout_width="match_parent"
                  android:layout_height="0dp"
                  android:layout_marginTop="16dp"
                  android:layout_marginBottom="16dp"
                  app:layout_constraintBottom_toTopOf="@+id/messageInputLayout"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/chatTitle" />
                  
              <com.google.android.material.textfield.TextInputLayout
                  android:id="@+id/messageInputLayout"
                  android:layout_width="0dp"
                  android:layout_height="wrap_content"
                  android:layout_marginStart="16dp"
                  android:layout_marginEnd="8dp"
                  android:layout_marginBottom="16dp"
                  android:hint="@string/message_hint"
                  app:layout_constraintBottom_toBottomOf="parent"
                  app:layout_constraintEnd_toStartOf="@+id/sendMessageButton"
                  app:layout_constraintStart_toStartOf="parent">
                  
                  <com.google.android.material.textfield.TextInputEditText
                      android:id="@+id/messageEditText"
                      android:layout_width="match_parent"
                      android:layout_height="wrap_content"
                      android:inputType="textMultiLine"
                      android:maxLines="4" />
                      
              </com.google.android.material.textfield.TextInputLayout>
              
              <Button
                  android:id="@+id/sendMessageButton"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginEnd="16dp"
                  android:text="@string/send_message"
                  app:layout_constraintBottom_toBottomOf="@+id/messageInputLayout"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintTop_toTopOf="@+id/messageInputLayout" />
                  
              <com.airbnb.lottie.LottieAnimationView
                  android:id="@+id/chatLoadingAnimation"
                  android:layout_width="100dp"
                  android:layout_height="100dp"
                  android:visibility="gone"
                  app:layout_constraintBottom_toBottomOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent"
                  app:lottie_autoPlay="true"
                  app:lottie_loop="true"
                  app:lottie_rawRes="@raw/loading_animation" />
                  
          </androidx.constraintlayout.widget.ConstraintLayout>
          EOF
          
          # Create activity_login.xml
          cat > app/src/main/res/layout/activity_login.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:app="http://schemas.android.com/apk/res-auto"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent">
              
              <TextView
                  android:id="@+id/welcomeTitle"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="64dp"
                  android:text="@string/welcome_title"
                  android:textAppearance="@style/TextAppearance.Material3.TitleLarge"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
                  
              <TextView
                  android:id="@+id/loginSubtitle"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="8dp"
                  android:text="@string/login_subtitle"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/welcomeTitle" />
                  
              <com.google.android.material.textfield.TextInputLayout
                  android:id="@+id/emailInputLayout"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginStart="32dp"
                  android:layout_marginTop="48dp"
                  android:layout_marginEnd="32dp"
                  android:hint="@string/email"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/loginSubtitle">
                  
                  <com.google.android.material.textfield.TextInputEditText
                      android:id="@+id/emailEditText"
                      android:layout_width="match_parent"
                      android:layout_height="wrap_content"
                      android:inputType="textEmailAddress" />
                      
              </com.google.android.material.textfield.TextInputLayout>
              
              <com.google.android.material.textfield.TextInputLayout
                  android:id="@+id/passwordInputLayout"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginStart="32dp"
                  android:layout_marginTop="16dp"
                  android:layout_marginEnd="32dp"
                  android:hint="@string/password"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/emailInputLayout"
                  app:passwordToggleEnabled="true">
                  
                  <com.google.android.material.textfield.TextInputEditText
                      android:id="@+id/passwordEditText"
                      android:layout_width="match_parent"
                      android:layout_height="wrap_content"
                      android:inputType="textPassword" />
                      
              </com.google.android.material.textfield.TextInputLayout>
              
              <Button
                  android:id="@+id/loginButton"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginStart="32dp"
                  android:layout_marginTop="32dp"
                  android:layout_marginEnd="32dp"
                  android:text="@string/login"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/passwordInputLayout" />
                  
              <Button
                  android:id="@+id/registerButton"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginStart="32dp"
                  android:layout_marginTop="8dp"
                  android:layout_marginEnd="32dp"
                  android:text="@string/register"
                  style="@style/Widget.Material3.Button.OutlinedButton"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/loginButton" />
                  
              <TextView
                  android:id="@+id/forgotPasswordTextView"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="16dp"
                  android:text="@string/forgot_password"
                  android:textColor="?attr/colorPrimary"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/registerButton" />
                  
              <com.airbnb.lottie.LottieAnimationView
                  android:id="@+id/loginLoadingAnimation"
                  android:layout_width="100dp"
                  android:layout_height="100dp"
                  android:visibility="gone"
                  app:layout_constraintBottom_toBottomOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent"
                  app:lottie_autoPlay="true"
                  app:lottie_loop="true"
                  app:lottie_rawRes="@raw/loading_animation" />
                  
          </androidx.constraintlayout.widget.ConstraintLayout>
          EOF

      - name: Grant execute permission for gradlew
        run: chmod +x gradlew

      - name: Create Keystore
        run: |
          mkdir -p keystore
          keytool -genkey -v \
            -keystore keystore/release.keystore \
            -alias ${{ secrets.KEY_ALIAS }} \
            -keyalg RSA \
            -keysize 2048 \
            -validity 10000 \
            -storepass ${{ secrets.KEY_STORE_PASSWORD }} \
            -keypass ${{ secrets.KEY_PASSWORD }} \
            -dname "CN=KiytoApp, OU=Development, O=Icarus-B4, L=Unknown, S=Unknown, C=DE"

      - name: Build Release APK
        env:
          SIGNING_KEY_ALIAS: ${{ secrets.KEY_ALIAS }}
          SIGNING_KEY_PASSWORD: ${{ secrets.KEY_PASSWORD }}
          SIGNING_STORE_PASSWORD: ${{ secrets.KEY_STORE_PASSWORD }}
          OPENAI_API_KEY: "dummy-key"
          GRADLE_ENTERPRISE_ACCESS_KEY: ${{ secrets.GRADLE_ENTERPRISE_ACCESS_KEY }}
        run: |
          # Verify environment
          java -version
          echo "ANDROID_HOME=$ANDROID_HOME"
          echo "PATH=$PATH"
          
          # Debug Gradle files
          echo "Checking Gradle files:"
          ls -la
          ls -la gradle/
          cat settings.gradle.kts
          cat build.gradle.kts
          
          # Clean and build
          ./gradlew clean assembleRelease --no-daemon --info --stacktrace \
            -Pandroid.useAndroidX=true \
            -Pandroid.enableJetifier=true || {
            
            echo "Build failed, checking logs..."
            
            if [ -f app/build/outputs/logs/manifest-merger-release-report.txt ]; then
              echo "Manifest merger log:"
              cat app/build/outputs/logs/manifest-merger-release-report.txt
            fi
            
            exit 1
          }

      - name: Sign APK
        env:
          BUILD_TOOLS_PATH: ${{ env.ANDROID_BUILD_TOOLS }}
          SIGNING_KEY_ALIAS: ${{ secrets.KEY_ALIAS }}
          SIGNING_KEY_PASSWORD: ${{ secrets.KEY_PASSWORD }}
          SIGNING_STORE_PASSWORD: ${{ secrets.KEY_STORE_PASSWORD }}
        run: |
          set -e
          
          echo "Signing APK..."
          $BUILD_TOOLS_PATH/zipalign -v -p 4 \
            app/build/outputs/apk/release/app-release-unsigned.apk \
            app/build/outputs/apk/release/app-release-aligned.apk
          
          $BUILD_TOOLS_PATH/apksigner sign --verbose \
            --ks keystore/release.keystore \
            --ks-key-alias "$SIGNING_KEY_ALIAS" \
            --ks-pass "pass:$SIGNING_STORE_PASSWORD" \
            --key-pass "pass:$SIGNING_KEY_PASSWORD" \
            --out app/build/outputs/apk/release/app-release.apk \
            app/build/outputs/apk/release/app-release-aligned.apk
          
          $BUILD_TOOLS_PATH/apksigner verify --verbose \
            app/build/outputs/apk/release/app-release.apk

      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          files: app/build/outputs/apk/release/app-release.apk
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Create Additional Layouts
        run: |
          # Create layout directory if it doesn't exist
          mkdir -p app/src/main/res/layout
          
          # Create activity_main.xml
          cat > app/src/main/res/layout/activity_main.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:app="http://schemas.android.com/apk/res-auto"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent"
              tools:context=".MainActivity">
          
              <TextView
                  android:id="@+id/welcomeTextView"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:text="@string/app_name"
                  android:textAppearance="@style/TextAppearance.Material3.TitleLarge"
                  app:layout_constraintBottom_toBottomOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
          
              <com.airbnb.lottie.LottieAnimationView
                  android:id="@+id/animationView"
                  android:layout_width="200dp"
                  android:layout_height="200dp"
                  android:layout_marginTop="24dp"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/welcomeTextView"
                  app:lottie_autoPlay="true"
                  app:lottie_loop="true"
                  app:lottie_rawRes="@raw/loading_animation" />
              
              <Button
                  android:id="@+id/settingsButton"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_margin="16dp"
                  android:text="@string/settings"
                  style="@style/Widget.Material3.Button.IconButton"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
          
          </androidx.constraintlayout.widget.ConstraintLayout>
          EOF
          
          # Create activity_about_me.xml
          cat > app/src/main/res/layout/activity_about_me.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:app="http://schemas.android.com/apk/res-auto"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent">
              
              <TextView
                  android:id="@+id/aboutMeTitle"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="32dp"
                  android:text="@string/app_name"
                  android:textAppearance="@style/TextAppearance.Material3.TitleLarge"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
                  
              <com.airbnb.lottie.LottieAnimationView
                  android:id="@+id/aboutMeAnimation"
                  android:layout_width="200dp"
                  android:layout_height="200dp"
                  android:layout_marginTop="32dp"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/aboutMeTitle"
                  app:lottie_autoPlay="true"
                  app:lottie_loop="true"
                  app:lottie_rawRes="@raw/success_animation" />
                  
          </androidx.constraintlayout.widget.ConstraintLayout>
          EOF
          
          # Create activity_ai_recommendations.xml
          cat > app/src/main/res/layout/activity_ai_recommendations.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:app="http://schemas.android.com/apk/res-auto"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent">
              
              <TextView
                  android:id="@+id/aiRecommendationsTitle"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="32dp"
                  android:text="@string/ai_recommendations"
                  android:textAppearance="@style/TextAppearance.Material3.TitleLarge"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
                  
              <TextView
                  android:id="@+id/productivityAnalysisLabel"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="32dp"
                  android:layout_marginStart="24dp"
                  android:layout_marginEnd="24dp"
                  android:text="@string/productivity_analysis"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/aiRecommendationsTitle" />
                  
              <TextView
                  android:id="@+id/focusRecommendationsLabel"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="16dp"
                  android:layout_marginStart="24dp"
                  android:layout_marginEnd="24dp"
                  android:text="@string/focus_recommendations"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/productivityAnalysisLabel" />
                  
              <TextView
                  android:id="@+id/taskOptimizationLabel"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="16dp"
                  android:layout_marginStart="24dp"
                  android:layout_marginEnd="24dp"
                  android:text="@string/task_optimization"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/focusRecommendationsLabel" />
                  
              <TextView
                  android:id="@+id/noTasksYetLabel"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:text="@string/no_tasks_yet"
                  android:visibility="gone"
                  app:layout_constraintBottom_toBottomOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
                  
              <com.airbnb.lottie.LottieAnimationView
                  android:id="@+id/aiRecommendationsAnimation"
                  android:layout_width="200dp"
                  android:layout_height="200dp"
                  android:layout_marginTop="32dp"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/taskOptimizationLabel"
                  app:lottie_autoPlay="true"
                  app:lottie_loop="true"
                  app:lottie_rawRes="@raw/loading_animation" />
                  
          </androidx.constraintlayout.widget.ConstraintLayout>
          EOF
          
          # Create activity_chat.xml
          cat > app/src/main/res/layout/activity_chat.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:app="http://schemas.android.com/apk/res-auto"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent">
              
              <TextView
                  android:id="@+id/chatTitle"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="16dp"
                  android:text="@string/chat"
                  android:textAppearance="@style/TextAppearance.Material3.TitleLarge"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
                  
              <androidx.recyclerview.widget.RecyclerView
                  android:id="@+id/chatRecyclerView"
                  android:layout_width="match_parent"
                  android:layout_height="0dp"
                  android:layout_marginTop="16dp"
                  android:layout_marginBottom="16dp"
                  app:layout_constraintBottom_toTopOf="@+id/messageInputLayout"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/chatTitle" />
                  
              <com.google.android.material.textfield.TextInputLayout
                  android:id="@+id/messageInputLayout"
                  android:layout_width="0dp"
                  android:layout_height="wrap_content"
                  android:layout_marginStart="16dp"
                  android:layout_marginEnd="8dp"
                  android:layout_marginBottom="16dp"
                  android:hint="@string/message_hint"
                  app:layout_constraintBottom_toBottomOf="parent"
                  app:layout_constraintEnd_toStartOf="@+id/sendMessageButton"
                  app:layout_constraintStart_toStartOf="parent">
                  
                  <com.google.android.material.textfield.TextInputEditText
                      android:id="@+id/messageEditText"
                      android:layout_width="match_parent"
                      android:layout_height="wrap_content"
                      android:inputType="textMultiLine"
                      android:maxLines="4" />
                      
              </com.google.android.material.textfield.TextInputLayout>
              
              <Button
                  android:id="@+id/sendMessageButton"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginEnd="16dp"
                  android:text="@string/send_message"
                  app:layout_constraintBottom_toBottomOf="@+id/messageInputLayout"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintTop_toTopOf="@+id/messageInputLayout" />
                  
              <com.airbnb.lottie.LottieAnimationView
                  android:id="@+id/chatLoadingAnimation"
                  android:layout_width="100dp"
                  android:layout_height="100dp"
                  android:visibility="gone"
                  app:layout_constraintBottom_toBottomOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent"
                  app:lottie_autoPlay="true"
                  app:lottie_loop="true"
                  app:lottie_rawRes="@raw/loading_animation" />
                  
          </androidx.constraintlayout.widget.ConstraintLayout>
          EOF
          
          # Create activity_login.xml
          cat > app/src/main/res/layout/activity_login.xml << 'EOF'
          <?xml version="1.0" encoding="utf-8"?>
          <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:app="http://schemas.android.com/apk/res-auto"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent">
              
              <TextView
                  android:id="@+id/welcomeTitle"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="64dp"
                  android:text="@string/welcome_title"
                  android:textAppearance="@style/TextAppearance.Material3.TitleLarge"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent" />
                  
              <TextView
                  android:id="@+id/loginSubtitle"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="8dp"
                  android:text="@string/login_subtitle"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/welcomeTitle" />
                  
              <com.google.android.material.textfield.TextInputLayout
                  android:id="@+id/emailInputLayout"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginStart="32dp"
                  android:layout_marginTop="48dp"
                  android:layout_marginEnd="32dp"
                  android:hint="@string/email"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/loginSubtitle">
                  
                  <com.google.android.material.textfield.TextInputEditText
                      android:id="@+id/emailEditText"
                      android:layout_width="match_parent"
                      android:layout_height="wrap_content"
                      android:inputType="textEmailAddress" />
                      
              </com.google.android.material.textfield.TextInputLayout>
              
              <com.google.android.material.textfield.TextInputLayout
                  android:id="@+id/passwordInputLayout"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginStart="32dp"
                  android:layout_marginTop="16dp"
                  android:layout_marginEnd="32dp"
                  android:hint="@string/password"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/emailInputLayout"
                  app:passwordToggleEnabled="true">
                  
                  <com.google.android.material.textfield.TextInputEditText
                      android:id="@+id/passwordEditText"
                      android:layout_width="match_parent"
                      android:layout_height="wrap_content"
                      android:inputType="textPassword" />
                      
              </com.google.android.material.textfield.TextInputLayout>
              
              <Button
                  android:id="@+id/loginButton"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginStart="32dp"
                  android:layout_marginTop="32dp"
                  android:layout_marginEnd="32dp"
                  android:text="@string/login"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/passwordInputLayout" />
                  
              <Button
                  android:id="@+id/registerButton"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:layout_marginStart="32dp"
                  android:layout_marginTop="8dp"
                  android:layout_marginEnd="32dp"
                  android:text="@string/register"
                  style="@style/Widget.Material3.Button.OutlinedButton"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/loginButton" />
                  
              <TextView
                  android:id="@+id/forgotPasswordTextView"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_marginTop="16dp"
                  android:text="@string/forgot_password"
                  android:textColor="?attr/colorPrimary"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toBottomOf="@+id/registerButton" />
                  
              <com.airbnb.lottie.LottieAnimationView
                  android:id="@+id/loginLoadingAnimation"
                  android:layout_width="100dp"
                  android:layout_height="100dp"
                  android:visibility="gone"
                  app:layout_constraintBottom_toBottomOf="parent"
                  app:layout_constraintEnd_toEndOf="parent"
                  app:layout_constraintStart_toStartOf="parent"
                  app:layout_constraintTop_toTopOf="parent"
                  app:lottie_autoPlay="true"
                  app:lottie_loop="true"
                  app:lottie_rawRes="@raw/loading_animation" />
                  
          </androidx.constraintlayout.widget.ConstraintLayout>
          EOF 